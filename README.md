# JANコード管理アプリ

JANコードの管理と、テキストからJANコードから重量までの自動抽出を行うデスクトップアプリケーションです。

## 機能

### 1. JANコードコピー
- Google Sheetsから指定した番目のJANコードを取得してコピー
- 次へ進む、一つ戻るボタンで連続操作
- デモモードでGoogle Sheets未接続時も動作

### 2. 座標取得
- 画面上の範囲をドラッグしてテキストをコピー
- 開始位置と終了位置を指定して自動ドラッグ

### 3. テキスト抽出（新機能）
- OCRを使わずにドラッグした範囲のテキストから正規表現でJANコードから重量を抽出
- 対応する重量形式：
  - `123g`、`123G`
  - `123グラム`
  - `重量：123g`、`重量 123g`
  - `123ｇ`（全角）
- 13桁または8桁のJANコードを自動検出
- 抽出結果を自動的にクリップボードにコピー

## インストール

### 必要なライブラリ
```bash
pip install customtkinter gspread oauth2client pyperclip pyautogui pillow
```

### 実行方法
```bash
python jan_code_app.py
```

## 使用方法

### テキスト抽出機能の使い方
1. 「抽出開始位置」ボタンをクリック
2. アプリが非表示になったら、抽出したいテキスト範囲の左上角にマウスを置く
3. 「抽出終了位置」ボタンが有効になるのでクリック
4. 抽出したいテキスト範囲の右下角にマウスを置く
5. 「JANコード～重量抽出」ボタンをクリック
6. アプリが自動的に範囲をドラッグしてテキストを取得し、JANコードから重量までを抽出してクリップボードにコピー

### Google Sheets連携（オプション）
- 認証ファイルのパス: `C:/pysample_01/samplep20240906-5ae36c9a4acd.json`
- 環境変数で設定可能:
  - `GOOGLE_CREDENTIALS_PATH`: 認証ファイルのパス
  - `SPREADSHEET_KEY`: スプレッドシートのキー
  - `WINDOW_POSITION`: ウィンドウ位置（`x,y`形式）

## ファイル出力
- `extract_result.txt`: テキスト抽出結果の詳細ログ
- `coordinates_and_content.txt`: 座標取得機能の結果ログ

## 技術仕様
- Python 3.11対応
- CustomTkinter使用の現代的なGUI
- 正規表現によるテキストパターンマッチング
- Google Sheets API連携
- クリップボード操作とマウス自動化

## 注意事項
- Windows環境での動作を前提
- Google Sheets機能を使用する場合は認証ファイルが必要
- 認証ファイルがない場合はデモモードで動作